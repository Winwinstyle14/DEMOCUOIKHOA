datas = [{
  id: 1,
  tensp: "Bánh quy cho chó 120g",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_e3edb1738c5d7384890a6710b769019d-300x300.jpg",
  gia: 28000,
  mota: "Bánh quy dừa phồng cứng, giòn tan với dầu dừa nguyên chất và trứng gà 120g",
  danhmuc: "Thức ăn",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 2,
  tensp: "Bánh thưởng Dog Treat",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_04c887716ac504f238cac9320043a0ac.jpg",
  gia: 25000,
  mota: "Bánh thưởng cho chó giúp răng chắc khỏe",
  danhmuc: "Thức ăn",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 3,
  tensp: "Classic chó nhỏ 400g",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_0c7438c7bb7c2d99c3a87072015d48ad.jpg",
  gia: 30000,
  mota: "Classic Pets Puppy 400g – Thức ăn cho chó con Vị sữa",
  danhmuc: "Thức ăn",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 4,
  tensp: "Royalcanin poodle ADULT 0,4kg",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_fed8c869bf1a0359f2b17175f8b1fb2d.jpg",
  gia: 130000,
  mota: "Đồ ăn Royal Canin Poodle Adult – Trọng lượng 500G – 1,5Kg – Đồ Ăn Dành Cho Chó – Thương Hiệu Quốc Tế",
  danhmuc: "Thức ăn",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1

},
{
  id: 5,
  tensp: "Dầu tắm M nâu chó đỏ nâu",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_78bd6dfc22ceabe9b91407478bd8b522-300x300.png",
  gia: 120000,
  mota: "Sữa tắm cao cấp M Rolay Care Cho Chó Mèo",
  danhmuc: "Sữa tắm",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 6,
  tensp: "Áo Cosplay Cá Sấu lót lông- Số 16",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_49f050642ab510715c55456bb4f7b038.jpg",
  gia: 200000,
  mota: "Không có mô tả",
  danhmuc: "Quần áo",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 7,
  tensp: "Áo cosplay Đường Tăng",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_626738a8b2f45d005ab485708642a148.jpg",
  gia: 175000,
  mota: "Không có mô tả",
  danhmuc: "Quần áo",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 8,
  tensp: "Áo gấu trúc",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_816298a2038fe5f290db336a3562b82b-300x300.jpg",
  gia: 98000,
  mota: "Không có mô tả",
  danhmuc: "Quần áo",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 9,
  tensp: "Bóng 7 màu bé",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_a5d89378714971d6cf505e2ee9667fde-300x300.png",
  gia: 25000,
  mota: "Một đồ chơi quả bóng cắn chịu đựng làm cho họa tiết cún cưng hoặc mèo của bạn cảm thấy thú vị và hài hước.",
  danhmuc: "Đồ chơi",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 10,
  tensp: "Bóng cao su bện đa sắc có chuông XS",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_88a46c8c81334937aa1e2d309964d054.png",
  gia: 15000,
  mota: "Chất liệu: Cao su tự nhiên, loại mềm an toàn, ko độc hại, ko làm tổn thương răng, đặc biệt tốt cho những Pet đang giai đoạn trưởng thành ngứa răng, ngứa lợi",
  danhmuc: "Đồ chơi",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 11,
  tensp: "Ba lô đeo kèm dây xích",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_d2abac60b95c543bc959c2e19ee18e83-300x300.jpg",
  gia: 14000,
  mota: "Chất liệu: Canvas cùng với phong cách: Thời trang, Dễ thương.",
  danhmuc: "Phụ kiện",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 12,
  tensp: "Áo mưa trong suốt viền trắng",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_264f397dabba131d9b49b535cf78f613.jpg",
  gia: 65000,
  mota: "Chất liệu: nhựa PVC cùng với kiểu dáng: Chui đầu, mũ áo trùm kín đầu và thân.",
  danhmuc: "Phụ kiện",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 13,
  tensp: "Ba lô chó lớn – Siêu nhân",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_65087b44a749968fc1e470f48532ca19-400x400.png",
  gia: 185000,
  mota: "Không có mô tả",
  danhmuc: "Phụ kiện",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 14,
  tensp: "Dầu tắm M tím khử mùi",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_65544114a1e8361413f93c6183130b4c-300x300.png",
  gia: 120000,
  mota: "Sữa tắm cao cấp M Rolay Care Cho Chó Mèo",
  danhmuc: "Sữa tắm",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 15,
  tensp: "Dầu tắm M vàng",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_7a7ba9e4d1e2e1e5b13e73cda15e0363-300x300.png",
  gia: 120000,
  mota: "Sữa tắm cao cấp M Rolay Care Cho Chó Mèo",
  danhmuc: "Sữa tắm",
  soluong: 100,
  soluongban: 1000,
  loai: "cho",
  count: 1
},
{
  id: 16,
  tensp: "Bánh thưởng Temptations",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_bcb3e9a066457346459b41333a048056-300x300.jpg",
  gia: 60000,
  mota: "Không có mô tả",
  danhmuc: "Thức ăn",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 17,
  tensp: "Me-o Adult 1.2 kg hải sản",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_903bcb84da214ca3464817a8add85eda-400x400.jpg",
  gia: 110000,
  mota: "Thành phần: Thức ăn cho mèo trưởng thành Me-O cung cấp đầy đủ các loại dinh dưỡng giúp thú cưng luôn khỏe mạnh, vui tươi và lanh lợi, cùng với chi phí hợp lý, ổn định và dễ kiểm soát được lượng thức ăn đầy đủ trong mỗi bữa ăn tùy theo trọng lượng, giống loài và tuổi của thú cưng",
  danhmuc: "Thức ăn",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 18,
  tensp: "Catsby 5kg",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_6205337d77b03b39b6ffdab2f5c5ab31-400x400.jpg",
  gia: 360000,
  mota: "Không có mô tả",
  danhmuc: "Thức ăn",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 19,
  tensp: "Royal canin indoor 2kg",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_2215ba5172cc5541768ab357b52892d4-400x400.jpg",
  gia: 410000,
  mota: "Indoor 27 là sản phẩm thức ăn khô dành cho mèo trưởng thành sống trong nhà trên 12 tháng tuổi của Royal Canin, Pháp.",
  danhmuc: "Thức ăn",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 20,
  tensp: "Dầu tắm SOS cho mèo",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_2da286580dc86f51046b7ad0936dae97-300x300.png",
  gia: 105000,
  mota: "Sữa tắm SOS cho mèo lông trắng và lông màu – Sữa tắm cho mèo giúp thú cưng luôn sạch sẽ, lông mềm mượt, sáng bóng, thơm lâu và diệt khuẩn cực tốt, phòng trừ ve rận cho tất cả các giống mèo.",
  danhmuc: "Sữa tắm",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 21,
  tensp: "Dầu tắm màu Nhật Bản petesthe 400ml",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_8f167ae653dd50ce5c656c674a97a49b-300x300.jpg",
  gia: 400000,
  mota: "Mềm mượt lông, phục hồi màu lông, dưỡng da và lưu giữ hương thơm lâu",
  danhmuc: "Sữa tắm",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 22,
  tensp: "Dầu tắm SENTEE trắng lông 500ml",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_1ef1efb3979c4854d0438e61a78779fc-400x400.jpg",
  gia: 70000,
  mota: "Công dụng: làm sáng màu lông, loại bỏ bụi bẩn, khử mùi, diệt khuẩn, lưu giữ lại hương thơm lâu, đặc biệt không gây hại da.",
  danhmuc: "Sữa tắm",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 23,
  tensp: "Áo nỉ có tay M",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_49fc37fb739b8780e65eff54de93b169-300x300.jpg",
  gia: 60000,
  mota: "Không có mô tả",
  danhmuc: "Quần áo",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 24,
  tensp: "Áo nỉ 4 chân M",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_8f6c9777aff440c7fe909d6097ae380e-300x300.jpg",
  gia: 110000,
  mota: "Không có mô tả",
  danhmuc: "Quần áo",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 25,
  tensp: "Bộ áo Cosplay Bác Sĩ",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_06c74eef35f38a9e60f0ced027d91030.jpg",
  gia: 130000,
  mota: "Không có mô tả",
  danhmuc: "Quần áo",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 26,
  tensp: "Bóng có chuột",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_c67423fe29adae3c901cbcaf307511bb-300x300.png",
  gia: 20000,
  mota: "Đường kính: 6cm, Chất liệu: Sắt, vải, Trọng lượng: 18g",
  danhmuc: "Đồ chơi",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 27,
  tensp: "Cần câu lông vũ",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_e0731c775956d190d326124344361364-300x300.jpg",
  gia: 40000,
  mota: "Không có mô tả",
  danhmuc: "Đồ chơi",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 28,
  tensp: "Chăn san hô fleece L",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_20b2cd098d580db004336f4c8cf6cc65-400x400.jpg",
  gia: 80000,
  mota: "100% Thương hiệu mới và chất lượng cao. Được làm bằng chất liệu nhung san hô, thoải mái và ấm áp.Đa chức năng chăn, cũng có thể được sử dụng như tắm cho thú cưng khăn và giấc ngủ mát, ấm đệm.",
  danhmuc: "Phụ kiện",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 29,
  tensp: "Gối bảo vệ mèo size L",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_e460799f13902877ce0d6a5a1fdb7612.jpg",
  gia: 110000,
  mota: "Không có mô tả",
  danhmuc: "Phụ kiện",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
{
  id: 30,
  tensp: "Chăn lông Kennel L",
  hinhanh: "https://megapet.vn/wp-content/uploads/2022/07/kiotviet_996a997157a03f07ce7b0736122cfa31.jpg",
  gia: 70000,
  mota: "Không có mô tả",
  danhmuc: "Phụ kiện",
  soluong: 100,
  soluongban: 1000,
  loai: "meo",
  count: 1
},
];

soluongsanpham(JSON.parse(localStorage.getItem("giohang")))

// hien thi san pham
let listData = [];
if (localStorage.getItem("datas")) {
  listData = JSON.parse(localStorage.getItem("datas"));
} else {
  localStorage.setItem("datas", JSON.stringify(datas));
}

let gridrow = document.querySelector(".product");
function loadData(datas) {
  return `<div class="grid__column2_4" >
    <div class="product-card" >
      <a class="product_link" >
        <div class="product-frame" onclick="chuyentrang(${datas.id})" >
          <img
            src="${datas.hinhanh}"
            class="product-img" alt="" />
        </div>
        <div class="product-caption" onclick="chuyentrang(${datas.id})" >
          <p class="product-name">${datas.tensp}</p>
          <p class="product-price">${datas.gia}</p>
          <p class="product-id" style="display: none;">${datas.id}</p>
          <p class="product-id" style="display: none;">${datas.count}</p>
        </div>
        <div class="product-action" onclick="themgiohang(this)" >
          <span><i class="fa-solid fa-cart-plus"></i></span>
        </div>
      </a>
    </div>
  </div>`
}
gridrow.innerHTML = listData.map(loadData).join('')


// chuyen trang chi tiet san pham
function chuyentrang(id) {

  window.location.href = "chitietsanpham.html";
  let newid = id - 1;
  let sanpham = listData[newid];
  localStorage.setItem("sanpham1", JSON.stringify(sanpham));

}

//Lay ra danh muc
function unique(arr) {
  var newArr = []
  for (var i = 0; i < arr.length; i++) {
    if (!newArr.includes(arr[i].danhmuc)) {
      newArr.push(arr[i].danhmuc)
    }
  }
  return newArr
}
listDanhmuc = unique(listData)

let category = document.querySelector(".category_list")
function loadDanhmuc(datas) {

  return `
    <li class="category_list_item category_item_active">
      <a href="" class="category_link">${datas}</a>
    </li>`
}
category.innerHTML = listDanhmuc.map(loadDanhmuc).join('')

// hien thi theo danh muc
let ul = document.querySelector(".category_list")
ul.addEventListener('click', function (e) {
  e.preventDefault();
  let danhmucuodcchon = e.target.innerText
  let load = listData.filter(data => data.danhmuc == danhmucuodcchon)
  gridrow.innerHTML = load.map(loadData).join('')
})
//tim kiem

const product = document.querySelector('.grid__row');
const forms = document.forms;
const search = forms['header__search_form'];
search.addEventListener('keyup', function (e) {
  e.preventDefault();
  const input = search.querySelector('input');
  const filter = input.value.toUpperCase();
  const grid_c = product.querySelectorAll('.grid__column2_4');
  for (let i = 0; i < grid_c.length; i++) {
    const div = grid_c[i].querySelector('.product-name');
    const name = div.textContent;
    if (name.toUpperCase().indexOf(filter) > -1) {
      grid_c[i].style.display = '';
    } else {
      grid_c[i].style.display = 'none';
    }
  }
})
// them vao gio hang
let giohang
if (localStorage.getItem('giohang')) {
  giohang = JSON.parse(localStorage.getItem('giohang'));
} else {
  giohang = []
}
function themgiohang(data) {
  let product = data.parentElement.children
  let productImg = product[0].children[0].src
  let productName = product[1].children[0].textContent
  let productPrice = product[1].children[1].textContent
  let productCount = 1
  let productId = product[1].children[2].textContent
  let productArr = { id: productId, img: productImg, name: productName, price: productPrice, count: productCount }
  let kt = 0
  for (let i = 0; i < giohang.length; i++) {
    if (giohang[i].name == productName) {
      kt = 1;
      productCount += giohang[i].count
      giohang[i].count = productCount
      break;
    }
  } if (kt == 0) {
    giohang.push(productArr)
  }

  localStorage.setItem("giohang", JSON.stringify(giohang));



  soluongsanpham(JSON.parse(localStorage.getItem("giohang")))
  total(JSON.parse(localStorage.getItem("giohang")))
  hienthigiohang(JSON.parse(localStorage.getItem("giohang")))

}



//hien gio hang
function hienthigiohang(giohang) {
  let cart_list_item = document.querySelector('.cart_list_item')
  function hienthisanpham(datas) {

    return ` <li class="cart_list_item1">
    <img
      src="${datas.img}"
      alt="" class="header_cart_item1" />
    <div class="cart_item_info">
      <h5 class="cart_text_pd">
      ${datas.name}
      </h5>
      <span class="cart_pd_price">${datas.price} VND</span>
      <span class="cart_pd_multiply">x</span>
      <span class="cart_pd_qnt">${datas.count}</span>
    </div>
    <div class="cart_item_info1">
    </div>
    </li> 
      `
  }
  cart_list_item.innerHTML = giohang.map(hienthisanpham).join('')

}



// gio hang
let click_header = document.querySelector('.header_cart')
let header__cart_list = document.querySelector('.header__cart_list')
click_header.addEventListener('click', function (e) {
  console.log(e.target.className)
  if (header__cart_list.style.display == 'block') {
    header__cart_list.style.display = 'none'
  }
  else {
    header__cart_list.style.display = 'block'
    hienthigiohang(JSON.parse(localStorage.getItem("giohang")))
    total(JSON.parse(localStorage.getItem("giohang")))
  }

})

// xem gio hang
xemgiohang()

function xemgiohang() {
  let btn_cart_pd = document.querySelector('.btn_cart_pd')
  btn_cart_pd.addEventListener('click', function () {
    window.location.href = "cart.html";
  })
}

// tinh tong tien 
function total(giohang) {
  let tong_tien = document.querySelector('.tong_tien')
  tongtien = 0;
  for (let i = 0; i < giohang.length; i++) {
    tongtien += giohang[i].price * giohang[i].count
  }
  tong_tien.innerHTML = ` ${tongtien} VND`
}

// so luong san pham
function soluongsanpham(datas) {
  let header_cart_num = document.querySelector('.header-cart-num')
  if (datas) {
    header_cart_num.innerHTML = `${datas.length}`
  } else {
    header_cart_num.innerHTML = `${0}`
  }
}

//Check account
let btn__DKDN = document.querySelector('.btn__DKDN');
let btn__DN = document.querySelector('.btn__DN');
let btn__DX = document.querySelector('.btn__DX');
function checkAccount() {
  let account_name = document.querySelector('.account_name');
  if (localStorage.getItem('account')) {
    let account = JSON.parse(localStorage.getItem("account"));
    btn__DKDN.style.display = 'none';
    btn__DN.style.display = 'none';
    btn__DX.style.display = 'block';
    account_name.style.display = '';
    account_name.innerHTML = `${account.username}`
  } else {
    btn__DKDN.style.display = 'block';
    btn__DN.style.display = 'block';
    btn__DX.style.display = 'none';
    account_name.style.display = 'none';
  }
}
checkAccount()
function dangxuat() {
  btn__DX.addEventListener('click', function (e) {
    localStorage.removeItem("account")
    checkAccount()
  })
}
dangxuat()

